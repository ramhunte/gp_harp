---
title: "R Notebook"
output: html_notebook
---

The goal of this document is to describe the process through which the asrp restoration scenarios are created in the NOAA model, including a description of inputs and model structure.  

##Input data
The three restoration scenarios are defined in the following data set, which was adapted from a spreadsheet we received through email:
```{r}
asrp_scenarios %>% 
  as.tibble()
```
We have adapted this table to accomodate our existing code structure, and have removed columns that were not relevant to our code from the spreadsheet provided to us.  Below is a description of each of the 10 columns included in our asrp scenario spreadsheet: 

1. GSU: The GSU in which restoratrion actions are defined. (GSU name)
2. LW: Do restoration scenarios target large wood?  (y/n)
3. Barriers: Do restoration scenarios target barrier removal? (y/n)
4. Floodplain: Do restoration scenarios target floodplain restoration and connectivity? (y/n)
5. Beaver: Do restoration scenarios target beaver habitat or beaver dam analogs? (y/n)
6. Riparian:  Do restoration scenarios target tree growth along stream channels? (y/n)
7. rest_perc_f: What percent of the GSU will be targeted for restoration? This applies to GSUs within managed forests only (percent of GSU in decimal form)
8. rest_perc_nf: What percent of the GSU will be targeted for restoration? This applies to GSUs outside of managed forest only (percent of GSU in decimal form) 
9. primary_cr_only: Do restoration actions target only the primary creek within a GSU? (y/n)
10. Scenario_num: Which scenario does this row describe? (Scenarios 1-3)

We add an additional column, `year` to the asrp scenario spreadsheet by replicating the asrp scenarios spreadsheet three times, once for each year considered in the asrp scenarios (2019/current, 2040/mid-century, 2080/late-century)

##2-asrp_reach_level_data.R

####Description:

In this script, we create a reach (noaaid) level table with asrp scenario information through a join of `flowline` with `asrp_scenarios`.

####Process: 

We begin by attaching a `Scenario_num` column to the `flowline` data frame.  This is done through an lapply/rbind where we replicate the `flowline` data frame once for each asrp scenario considered (scenarios 1-3, scenarios 1-3 wood only, scenarios 1-3 fp only, scenarios 1-3 beaver only), and add each scenario name to `flowline` using `mutate`.  

We then replicate `flowline` three more times, once for each year considered (2019/current, 2040/mid-century, and 2080/late-century), and then remove the scenario/year combinations that we do not consider in the asrp scenario code.







#The code after this line is not used anymore












The NOAA model considers the following five restoration actions when creating the three ASRP restoration scenarios:

1. Large wood
2. Beavers
3. Floodplain
4. Riparian restoration and shading
5. Barrier removal

Restoration actions and percentages are assigned at the GSU level.  For example, consider ASRP scenario 1 shown below:

```{r}
asrp_scenarios %>% 
  filter(Scenario_num == 'scenario_1') %>%
  arrange(GSU) %>%
  as.tibble
```
Bingham creek recieves restoration action for large wood, barriers, floodplain and riparian habitat, but not for beaver habitat.  Restoration is targeted at 33% of the GSU.  
